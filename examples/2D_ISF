from surface_potential_analysis.basis.time_basis_like import EvenlySpacedTimeBasis
from surface_potential_analysis.state_vector.plot import plot_state_2d_x
from surface_potential_analysis.state_vector.plot_value_list import (
    plot_value_list_against_time,
)

from coherent_rates.isf import get_boltzmann_isf, get_random_boltzmann_state
from coherent_rates.plot import plot_system_eigenstates_2d
from coherent_rates.system import HYDROGEN_NICKEL_SYSTEM_2D, PeriodicSystemConfig

if __name__ == "__main__":
    config = PeriodicSystemConfig((5, 5), (10, 10), 100, temperature=155)
    system = HYDROGEN_NICKEL_SYSTEM_2D
    times = EvenlySpacedTimeBasis(100, 1, 0, 0.6e-13)
    plot_system_eigenstates_2d(system, config, 96)
    state = get_random_boltzmann_state(system, config)
    fig, ax, line = plot_state_2d_x(state)
    fig.show()
    input()
    n = (10, 10)
    isf = get_boltzmann_isf(system, config, times, n)
    fig, ax, line = plot_value_list_against_time(isf)
    fig.show()
    input()
